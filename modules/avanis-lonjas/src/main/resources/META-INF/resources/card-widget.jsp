<%@ include file="/init.jsp" %>
<jsp:directive.page contentType="text/html" pageEncoding="UTF-8"/>

<!-- Card del widget de lonjas y mercados -->
<div class="av-lmw__card">
	<div class="av-lmw__card-row av-lmw__card-row--001">
		<span>${producto.nombreProducto}</span>
	</div>
	<div class="av-lmw__card-row av-lmw__card-row--002">
		<div class="av-lmw__card-price-units">
			<span class="av-lmw__card-price">${producto.precioUltimo}</span>
            <span class="av-lmw__card-units">${producto.unidadMedida}</span>
		</div>

		<!-- TODO - Cambiar la palabra "success" por la que corresponda para dar color a la etiqueta ("error" o "neutral"). -->

		<c:set var="variacionStr" value="${producto.variacionPorcentaje}" />
        <c:set var="variacionNum" value="${fn:replace(variacionStr, ',', '.')}" />
        <c:set var="variacionNum" value="${fn:substring(variacionNum, 0, fn:length(variacionNum)-1)}" />
        <c:set var="variacionPorcentaje" value="${variacionNum + 0.0}" />

        <c:choose>
            <c:when test="${variacionPorcentaje > 0}">
                <div class="av-lmw__card-variation av-lmw__card-variation--success">
                    <svg width="10" height="12" viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M4.52827 0.861949C4.78862 0.6016 5.21073 0.6016 5.47108 0.861949L9.47108 4.86195C9.73143 5.1223 9.73143 5.54441 9.47108 5.80476C9.21073 6.06511 8.78862 6.06511 8.52827 5.80476L5.66634 2.94283V10.6667C5.66634 11.0349 5.36786 11.3334 4.99967 11.3334C4.63148 11.3334 4.33301 11.0349 4.33301 10.6667V2.94283L1.47108 5.80476C1.21073 6.06511 0.788619 6.06511 0.52827 5.80476C0.26792 5.54441 0.26792 5.1223 0.52827 4.86195L4.52827 0.861949Z" fill="#228262" />
                    </svg>
            </c:when>
            <c:when test="${variacionPorcentaje < 0}">
                <div class="av-lmw__card-variation av-lmw__card-variation--error">
                    <svg width="10" height="12" viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.47108 11.1381C5.21073 11.3984 4.78862 11.3984 4.52827 11.1381L0.52827 7.13805C0.26792 6.8777 0.26792 6.45559 0.52827 6.19524C0.788619 5.93489 1.21073 5.93489 1.47108 6.19524L4.33301 9.05717V1.33333C4.33301 0.965141 4.63148 0.666664 4.99967 0.666664C5.36786 0.666664 5.66634 0.965141 5.66634 1.33333V9.05717L8.52827 6.19524C8.78862 5.93489 9.21073 5.93489 9.47108 6.19524C9.73143 6.45559 9.73143 6.8777 9.47108 7.13805L5.47108 11.1381Z" fill="#FF0000"/>
                    </svg>
            </c:when>
            <c:otherwise>
                <div class="av-lmw__card-variation av-lmw__card-variation--neutral">
                <svg width="10" height="2" viewBox="0 0 10 2" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="10" height="2" fill="#646B6B"/>
                </svg>
            </c:otherwise>
        </c:choose>

			<span>${producto.variacionPorcentaje}%</span>
		</div>
	</div>
	<div class="av-lmw__card-row av-lmw__card-row--003">

		<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path fill-rule="evenodd" clip-rule="evenodd" d="M4.66634 1.33331C5.03453 1.33331 5.33301 1.63179 5.33301 1.99998V2.66665H10.6663V1.99998C10.6663 1.63179 10.9648 1.33331 11.333 1.33331C11.7012 1.33331 11.9997 1.63179 11.9997 1.99998V2.66666C12.3057 2.66685 12.5725 2.66874 12.7964 2.68703C13.0599 2.70856 13.3221 2.7561 13.5743 2.88463C13.9506 3.07638 14.2566 3.38234 14.4484 3.75867C14.5769 4.01092 14.6244 4.27306 14.646 4.53663C14.6664 4.78634 14.6664 5.08951 14.6663 5.44094V11.8924C14.6664 12.2438 14.6664 12.547 14.646 12.7967C14.6244 13.0602 14.5769 13.3224 14.4484 13.5746C14.2566 13.951 13.9506 14.2569 13.5743 14.4487C13.3221 14.5772 13.0599 14.6247 12.7964 14.6463C12.5467 14.6667 12.2435 14.6667 11.8921 14.6666H4.1073C3.75587 14.6667 3.4527 14.6667 3.20299 14.6463C2.93943 14.6247 2.67728 14.5772 2.42503 14.4487C2.0487 14.2569 1.74274 13.951 1.551 13.5746C1.42247 13.3224 1.37492 13.0602 1.35339 12.7967C1.33299 12.547 1.333 12.2438 1.33301 11.8923V5.44095C1.333 5.08952 1.33299 4.78634 1.35339 4.53663C1.37492 4.27306 1.42247 4.01092 1.551 3.75867C1.74274 3.38234 2.0487 3.07638 2.42503 2.88463C2.67728 2.7561 2.93943 2.70856 3.20299 2.68703C3.42684 2.66874 3.69365 2.66685 3.99968 2.66666V1.99998C3.99968 1.63179 4.29815 1.33331 4.66634 1.33331ZM4.13301 3.99998C3.74864 3.99998 3.50046 4.0005 3.31157 4.01593C3.13046 4.03073 3.06331 4.05585 3.03035 4.07264C2.90491 4.13656 2.80292 4.23854 2.739 4.36399C2.72221 4.39695 2.69709 4.46409 2.68229 4.6452C2.66686 4.8341 2.66634 5.08228 2.66634 5.46665V5.99998H13.333V5.46665C13.333 5.08228 13.3325 4.8341 13.3171 4.6452C13.3023 4.46409 13.2771 4.39695 13.2603 4.36399C13.1964 4.23854 13.0944 4.13656 12.969 4.07264C12.936 4.05585 12.8689 4.03073 12.6878 4.01593C12.4989 4.0005 12.2507 3.99998 11.8663 3.99998H4.13301ZM13.333 7.33331H2.66634V11.8666C2.66634 12.251 2.66686 12.4992 2.68229 12.6881C2.69709 12.8692 2.72221 12.9363 2.739 12.9693C2.80292 13.0947 2.90491 13.1967 3.03035 13.2607C3.06331 13.2774 3.13046 13.3026 3.31157 13.3174C3.50046 13.3328 3.74864 13.3333 4.13301 13.3333H11.8663C12.2507 13.3333 12.4989 13.3328 12.6878 13.3174C12.8689 13.3026 12.936 13.2774 12.969 13.2607C13.0944 13.1967 13.1964 13.0947 13.2603 12.9693C13.2771 12.9363 13.3023 12.8692 13.3171 12.6881C13.3325 12.4992 13.333 12.251 13.333 11.8666V7.33331Z" fill="#646B6B"/>
		</svg>

		<span>${producto.fechaLonja}</span>
	</div>
	<div class="av-lmw__card-row av-lmw__card-row--004">

		<svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path fill-rule="evenodd" clip-rule="evenodd" d="M3.60908 -0.000104775C3.62633 -3.92891e-05 3.64317 2.46071e-05 3.65954 2.46071e-05H10.3411C10.3574 2.46071e-05 10.3743 -3.92891e-05 10.3915 -0.000104775C10.5755 -0.000803341 10.8068 -0.00168136 11.023 0.0728977C11.2099 0.13734 11.38 0.242511 11.5212 0.380801C11.6846 0.540836 11.7873 0.748094 11.869 0.912986C11.8766 0.92845 11.8841 0.94354 11.8914 0.958185L13.2201 3.61555C13.2756 3.72658 13.3358 3.8468 13.3772 3.9528C13.4206 4.06393 13.4835 4.25397 13.4502 4.47951C13.41 4.75163 13.2595 4.99517 13.0341 5.15281C12.8473 5.28349 12.6491 5.31219 12.5303 5.32306C12.4693 5.32865 12.4021 5.33122 12.3336 5.33239V11.3334C12.3336 11.7015 12.0352 12 11.667 12C11.2988 12 11.0003 11.7015 11.0003 11.3334V5.33336H3.0003V8.00002H8.33364V7.33336C8.33364 6.96517 8.63211 6.66669 9.0003 6.66669C9.36849 6.66669 9.66697 6.96517 9.66697 7.33336L9.66697 9.7574C9.66699 10.0168 9.667 10.2502 9.65113 10.4444C9.63414 10.6524 9.59568 10.8734 9.48531 11.09C9.32553 11.4036 9.07056 11.6586 8.75695 11.8184C8.54035 11.9287 8.31937 11.9672 8.11139 11.9842C7.91718 12.0001 7.68376 12 7.42438 12H3.90957C3.65018 12 3.41676 12.0001 3.22255 11.9842C3.01457 11.9672 2.79359 11.9287 2.57699 11.8184C2.26338 11.6586 2.00842 11.4036 1.84863 11.09C1.73826 10.8734 1.6998 10.6524 1.68281 10.4444C1.66694 10.2502 1.66695 10.0168 1.66697 9.75742L1.66697 5.33239C1.59855 5.33122 1.53135 5.32865 1.47028 5.32306C1.35147 5.31219 1.15334 5.28349 0.966508 5.15281C0.741105 4.99516 0.590592 4.75163 0.550388 4.47952C0.517064 4.25397 0.580002 4.06393 0.623409 3.9528C0.664812 3.8468 0.724964 3.72657 0.780515 3.61555C0.783674 3.60924 0.786818 3.60295 0.789943 3.5967L2.1092 0.958188C2.11652 0.943546 2.12399 0.928457 2.13165 0.912997C2.21332 0.748096 2.31597 0.54084 2.47937 0.3808C2.62056 0.242512 2.79073 0.137341 2.97757 0.0728976C3.19378 -0.00168128 3.42506 -0.000803341 3.60908 -0.000104775ZM11.9216 4.00002L10.6988 1.55448C10.6417 1.44024 10.6121 1.38163 10.5882 1.34044C10.5875 1.3392 10.5868 1.33802 10.5861 1.33689C10.5848 1.3368 10.5834 1.33671 10.582 1.33662C10.5345 1.33366 10.4688 1.33336 10.3411 1.33336H3.65954C3.53182 1.33336 3.46614 1.33366 3.41861 1.33662C3.41718 1.33671 3.41581 1.3368 3.41451 1.33689C3.41384 1.33802 3.41315 1.3392 3.41243 1.34044C3.38853 1.38162 3.35889 1.44023 3.30177 1.55447L2.07899 4.00002H11.9216ZM3.0003 9.33336V9.73336C3.0003 10.0244 3.00082 10.2026 3.01171 10.3359C3.01679 10.398 3.02316 10.4355 3.02853 10.4584C3.03109 10.4692 3.03323 10.4759 3.03452 10.4795C3.03576 10.483 3.0365 10.4844 3.03664 10.4847C3.06859 10.5474 3.11959 10.5984 3.18231 10.6304C3.18258 10.6305 3.18403 10.6312 3.1875 10.6325C3.19111 10.6338 3.19778 10.6359 3.20864 10.6385C3.23145 10.6438 3.26903 10.6502 3.33113 10.6553C3.46443 10.6662 3.64261 10.6667 3.93364 10.6667H7.4003C7.69133 10.6667 7.86951 10.6662 8.00281 10.6553C8.06491 10.6502 8.10249 10.6438 8.1253 10.6385C8.13616 10.6359 8.14283 10.6338 8.14644 10.6325C8.14991 10.6312 8.15136 10.6305 8.15163 10.6304C8.21435 10.5984 8.26535 10.5474 8.29731 10.4847C8.29744 10.4844 8.29818 10.483 8.29942 10.4795C8.30071 10.4759 8.30285 10.4692 8.30541 10.4584C8.31078 10.4355 8.31715 10.398 8.32223 10.3359C8.33312 10.2026 8.33364 10.0244 8.33364 9.73336V9.33336H3.0003Z" fill="#646B6B"/>
		</svg>

		<span>Lonja de ${producto.nombreLonja}</span>
	</div>
</div>
